{{ header }}
<main id="cart-page">
  {{ content_top }}
  <div class="container">
    <nav class="breadcrumb py-4" aria-label="breadcrumbs">
      <ul>
        {% for key, breadcrumb in breadcrumbs %}
        {% if key < (breadcrumbs|length - 1) %}
        <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
        {% else %}
        <li><span>{{ breadcrumb.text }}</span></li>
        {% endif %}
        {% endfor %}
      </ul>
    </nav>
    <div class="columns is-multiline">
      {{ column_left }}
      {% if column_left and column_right %}
      {% set class = 'column is-6' %}
      {% elseif column_left or column_right %}
      {% set class = 'column is-9' %}
      {% else %}
      {% set class = 'column is-12' %}
      {% endif %}
      <div id="content" class="{{ class }}">
        <h1 class="title is-3">{{ heading_title }}</h1>
        {% if error_warning %}
        <div class="notification is-danger is-light has-text-centered">{{ error_warning }}</div>  
        {% endif %}
        {% if products or vouchers %}
        <div id="cart-content">
          <div class="columns is-mobile is-multiline">
            <div id="cart-products" class="column is-8-fullhd is-8-widescreen is-8-desktop is-12-tablet is-12-mobile">
              <form id="cart-form" class="box is-relative is-clipped">
                {% for product in products %}
                <div class="cart-item columns is-mobile is-flex-wrap-wrap is-relative" data-cart-id="{{ product.cart_id }}">
                  <div class="cart-image column is-narrow is-relative">
                    {% if product.thumb %}
                    <a href="{{ product.href }}" class="is-block is-relative">
                      <img src="{{ product.thumb }}" alt="{{ product.name }}" title="{{ product.name }}" style="border-radius: 0.5rem;" />
                    </a>
                    {% endif %}
                  </div>
                  <div class="column">                        
                    <a href="{{ product.href }}" class="is-size-5-desktop is-size-5-tablet is-size-6-mobile is-block has-text-link mb-2">{{ product.name }}</a>
                    {% if not product.stock %}
                    <p><span class="tag is-danger">{{ text_pre_order }}</span></p>
                    {% endif %}
                    {% if product.option %}
                    <div class="cart-options">
                      {% for option in product.option %}
                      <small class="is-block has-text-grey">{{ option.name }}: <span class="has-text-black">{{ option.value }}</span></small>
                      {% endfor %}
                    </div>
                    {% endif %}
                    <div class="block my-2">
                      <div class="field is-grouped">
                        <div class="field has-addons mb-0 quantity-counter">
                          <p class="control">
                            <button type="button" class="button minus" aria-label="{{ text_decrease }}">
                              <span class="icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                  <path fill-rule="evenodd" d="M2 8a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11A.5.5 0 0 1 2 8Z"/>
                                </svg>
                              </span>
                            </button>
                          </p>
                          <p class="control">
                            <input type="text" name="quantity" inputmode="decimal" style="max-width: 60px;" data-key="{{ product.cart_id }}" data-minimum="{{ product.minimum }}" class="input-quantity input has-text-centered" value="{{ product.quantity }}" maxlength="5" />
                          </p>
                          <p class="control">
                            <button type="button" class="button plus" aria-label="{{ text_increase }}">
                              <span class="icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">
                                  <path fill-rule="evenodd" d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2Z"/>
                                </svg>
                              </span>
                            </button>
                          </p>
                        </div>
                        <div class="field ml-3 mb-0">
                          <button type="button" class="cart-delete-product button is-danger is-light" data-key="{{ product.cart_id }}" aria-label="{{ text_delete }}">
                            <span class="icon">
                              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="-0.5 -0.5 16 16" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" height="24" width="24">
                                <path d="m11.25 5.625 -0.525 5.248749999999999c-0.079375 0.7956249999999999 -0.11875 1.193125 -0.3 1.4937500000000001a1.5625 1.5625 0 0 1 -0.671875 0.608125C9.436250000000001 13.125 9.037500000000001 13.125 8.2375 13.125h-1.4749999999999999c-0.799375 0 -1.19875 0 -1.515625 -0.15a1.5625 1.5625 0 0 1 -0.6725000000000001 -0.608125c-0.18 -0.3 -0.21999999999999997 -0.6975 -0.3 -1.4931249999999998L3.75 5.625m4.6875 4.0625v-3.125m-1.875 3.125v-3.125m-3.75 -2.5h2.8843750000000004m0 0 0.24125000000000002 -1.6700000000000002c0.07 -0.30374999999999996 0.3225 -0.5175 0.6125 -0.5175h1.89875c0.29000000000000004 0 0.541875 0.21375000000000002 0.6125 0.5175l0.24125000000000002 1.6700000000000002m-3.6062499999999997 0h3.6062499999999997m0 0H12.1875" stroke-width="1"></path>
                              </svg>
                            </span>
                          </button>
                        </div>
                      </div>
                    </div>
                    <div class="block mb-0 is-size-7">
                      <span class="per-one">{{ product.price }}</span> / <span class="has-text-weight-bold">{{ product.total }}</span>
                    </div>
                    {% if product.reward %}
                    <div class="cart-reward is-flex is-align-items-center mt-3">
                      <span class="icon-text">
                        <span class="icon has-text-success">
                          <svg width="1.4rem" height="1.4rem" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M20 12V21.4C20 21.7314 19.7314 22 19.4 22H4.6C4.26863 22 4 21.7314 4 21.4V12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M21.4 7H2.6C2.26863 7 2 7.26863 2 7.6V11.4C2 11.7314 2.26863 12 2.6 12H21.4C21.7314 12 22 11.7314 22 11.4V7.6C22 7.26863 21.7314 7 21.4 7Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 22V7" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 7H7.5C6.83696 7 6.20107 6.73661 5.73223 6.26777C5.26339 5.79893 5 5.16304 5 4.5C5 3.83696 5.26339 3.20107 5.73223 2.73223C6.20107 2.26339 6.83696 2 7.5 2C11 2 12 7 12 7Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 7H16.5C17.163 7 17.7989 6.73661 18.2678 6.26777C18.7366 5.79893 19 5.16304 19 4.5C19 3.83696 18.7366 3.20107 18.2678 2.73223C17.7989 2.26339 17.163 2 16.5 2C13 2 12 7 12 7Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
                          </svg>
                        </span>
                        <span>{{ product.reward }}</span>
                      </span>
                    </div>
                    {% endif %}
                  </div>
                </div>
                {% endfor %}
                {% for voucher in vouchers %}
                <div class="columns is-mobile is-flex-wrap-wrap">
                  <div class="column is-2-fullhd is-2-widescreen is-2-desktop is-2-tablet is-4-mobile has-text-centered p-3">
                    <div class="is-block is-relative">
                      <span class="icon is-large has-text-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" fill="currentColor" viewBox="0 0 16 16">
                          <path d="M3 2.5a2.5 2.5 0 0 1 5 0 2.5 2.5 0 0 1 5 0v.006c0 .07 0 .27-.038.494H15a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1v7.5a1.5 1.5 0 0 1-1.5 1.5h-11A1.5 1.5 0 0 1 1 14.5V7a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h2.038A3 3 0 0 1 3 2.506zm1.068.5H7v-.5a1.5 1.5 0 1 0-3 0c0 .085.002.274.045.43zM9 3h2.932l.023-.07c.043-.156.045-.345.045-.43a1.5 1.5 0 0 0-3 0zM1 4v2h6V4zm8 0v2h6V4zm5 3H9v8h4.5a.5.5 0 0 0 .5-.5zm-7 8V7H2v7.5a.5.5 0 0 0 .5.5z"/>
                        </svg>
                      </span>
                    </div>
                  </div>
                  <div class="column is-10-fullhd is-10-widescreen is-10-desktop is-10-tablet is-8-mobile is-10-desktop is-8-mobile">
                    <div class="columns">
                      <div class="column is-9-fullhd is-8-widescreen is-7-desktop is-8-tablet is-12-mobile">
                        <span class="is-size-5-desktop is-size-5-tablet is-size-6-mobile is-block has-text-link my-2">{{ voucher.description }}</span>
                      </div>
                      <div class="column is-3-fullhd is-4-widescreen is-5-desktop is-4-tablet is-12-mobile">
                        <div class="block mb-2">
                          <div class="field is-grouped is-justify-content-flex-end">
                            <div class="field has-addons mb-0 quantity-counter">
                              <p class="control">
                                <input type="text" value="1" class="input has-text-centered" disabled="disabled" maxlength="1" style="max-width: 60px;" />
                              </p>
                            </div>
                            <div class="field ml-3 mb-0">
                              <p class="control">
                                <a class="cart-delete-product button is-danger is-light" data-key="{{ voucher.key }}">
                                  <span class="icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="-0.5 -0.5 16 16" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" height="24" width="24">
                                      <path d="m11.25 5.625 -0.525 5.248749999999999c-0.079375 0.7956249999999999 -0.11875 1.193125 -0.3 1.4937500000000001a1.5625 1.5625 0 0 1 -0.671875 0.608125C9.436250000000001 13.125 9.037500000000001 13.125 8.2375 13.125h-1.4749999999999999c-0.799375 0 -1.19875 0 -1.515625 -0.15a1.5625 1.5625 0 0 1 -0.6725000000000001 -0.608125c-0.18 -0.3 -0.21999999999999997 -0.6975 -0.3 -1.4931249999999998L3.75 5.625m4.6875 4.0625v-3.125m-1.875 3.125v-3.125m-3.75 -2.5h2.8843750000000004m0 0 0.24125000000000002 -1.6700000000000002c0.07 -0.30374999999999996 0.3225 -0.5175 0.6125 -0.5175h1.89875c0.29000000000000004 0 0.541875 0.21375000000000002 0.6125 0.5175l0.24125000000000002 1.6700000000000002m-3.6062499999999997 0h3.6062499999999997m0 0H12.1875" stroke-width="1"></path>
                                    </svg>
                                  </span>
                                </a>
                              </p>
                            </div>
                          </div>
                        </div>
                        <div class="block mb-0 has-text-right">
                          <span class="has-text-weight-bold">{{ voucher.amount }}</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                {% endfor %}
              </form>
              {% if modules %}
              <div class="box mb-5">
                <div class="columns is-multiline">
                  {% for module in modules %}
                  {{ module }}
                  {% endfor %}
                </div>
              </div>
              {% endif %}
            </div>
            <div id="cart-total" class="column is-4-fullhd is-4-widescreen is-4-desktop is-12-tablet is-12-mobile">
              <div class="box mb-5">
                <div class="title is-4">
                  {{ text_your_order }}
                </div>
                <ul class="heading-list">
                  {% for total in totals %}
                  <li class="is-flex is-justify-content-space-between is-align-items-center py-1">
                    <span class="has-background-white pr-1">
                      {{ total.title }}
                    </span>
                    <span class="has-background-white has-text-weight-bold pl-1">
                      {{ total.text }}
                    </span>
                  </li>
                  {% endfor %}
                  {% if weight %}
                  <li class="is-flex is-justify-content-space-between is-align-items-center py-1">
                    <span class="has-background-white pr-1">
                      {{ text_weight }}
                    </span>
                    <span class="has-background-white has-text-weight-bold pl-1">
                      {{ weight }}
                    </span>
                  </li>
                  {% endif %}
                </ul>                
                <div class="block mt-5 mb-0">
                  <a href="{{ checkout }}" class="button is-primary is-medium is-fullwidth">{{ text_goto_checkout }}</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        {% else %}
        <div id="cart-content">
          <div class="block">
            {{ text_empty }}
          </div>
          <div class="buttons my-3">
            <a href="{{ continue }}" class="button is-primary is-light">{{ button_continue }}</a>
          </div>
        </div>
        {% endif %}
      </div>
      {{ column_right }}
    </div>
  </div>
  {{ content_bottom }}
</main>
<script>
  $('#cart-page').on('change', '.input-quantity', function (e) {
    e.preventDefault();
    cart.update($(this).data('key'), $(this).val(), $(this));
  });

  $('#cart-page').on('keydown', '.input-quantity', function (e) {
    if (e.keyCode == 13) {
      e.preventDefault();
      cart.update($(this).data('key'), $(this).val(), $(this));
    }
  });
</script>
{{ footer }}
