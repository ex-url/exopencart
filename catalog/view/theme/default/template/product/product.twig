{{ header }}
<main id="product-page">
  {{ content_top }}
  <div class="container">
    <nav class="breadcrumb py-4" aria-label="breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList">
      <ul>
        {% for key, breadcrumb in breadcrumbs %}
        {% if key < (breadcrumbs|length - 1) %} <li itemprop="itemListElement" itemscope
          itemtype="https://schema.org/ListItem">
          <a href="{{ breadcrumb.href }}" itemprop="item">{{ breadcrumb.text }}</a>
          </li>
          {% else %}
          <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
            <span itemprop="item">{{ breadcrumb.text }}</span>
          </li>
          {% endif %}
          {% endfor %}
      </ul>
    </nav>
    <div class="columns is-multiline">
      {{ column_left }}
      {% if column_left and column_right %}
      {% set class = 'column is-6-fullhd is-6-widescreen is-6-desktop is-12-tablet is-12-mobile' %}
      {% elseif column_left or column_right %}
      {% set class = 'column is-9-fullhd is-9-widescreen is-9-desktop is-12-tablet is-12-mobile' %}
      {% else %}
      {% set class = 'column is-12' %}
      {% endif %}
      <div id="content" class="{{ class }}" itemscope itemtype="https://schema.org/Product">
        <h1 class="title is-3 has-text-weight-normal" id="heading" itemprop="name">{{ heading_title }}</h1>
        <div class="tabs mb-5 has-background-white-bis">
          <ul>
            <li class="is-active" data-target="#heading">
              <a>{{ tab_general }}</a>
            </li>
            {% if attribute_groups %}
            <li class="" data-target="#product-attributes">
              <a>{{ tab_attribute }}</a>
            </li>
            {% endif %}
            {% if review_status %}
            <li class="" data-target="#product-reviews">
              <a>{{ tab_review }}</a>
            </li>
            {% endif %}
          </ul>
        </div>
        <div class="columns is-multiline">
          {% if column_left and column_right %}
          {% set class = 'column is-12-desktop is-12-tablet is-12-mobile' %}
          {% elseif column_left or column_right %}
          {% set class = 'column is-5-desktop is-12-tablet is-12-mobile' %}
          {% else %}
          {% set class = 'column is-6-desktop is-12-tablet is-12-mobile' %}
          {% endif %}
          <div class="{{ class }}">
            <div id="product-images" class="swiper box p-0 is-clipped  ">
              <div class="swiper-wrapper">
                {% if thumb %}
                <div class="swiper-slide">
                  <a href="{{ popup }}" data-fancybox="product" data-caption="{{ heading_title }}">
                    <img src="{{ thumb }}" itemprop="image" width="{{ image_width }}" height="{{ image_heigth }}"
                      title="{{ heading_title }}" alt="{{ heading_title }}" />
                  </a>
                </div>
                {% endif %}
                {% if images %}
                {% for image in images %}
                <div class="swiper-slide">
                  <a href="{{ image.popup }}" data-fancybox="product"
                    data-caption="{{ image.title ? image.title : heading_title }}">
                    <img src="{{ image.thumb }}" itemprop="image" width="{{ image_width }}" height="{{ image_heigth }}"
                      title="{{ image.title ? image.title : heading_title }}"
                      alt="{{ image.title ? image.title : heading_title }}" />
                  </a>
                </div>
                {% endfor %}
                {% endif %}
              </div>
              <div class="swiper-pagination"></div>
              {% if stickers %}
              <span class="stickers is-block mb-0">
              {% for sticker in stickers %}
                <span class="{{ sticker.class }}">{{ sticker.content|html_entity_decode }}</span>
              {% endfor %}
              </span>
              {% endif %}
              {% if discount %}
              <span class="discount tag is-danger">
              -{{ discount }}%
              </span>
              {% endif %}
            </div>
            <div class="sticky-crutch"></div>
          </div>
          {% if column_left and column_right %}
          {% set class = 'column is-12-desktop is-12-tablet is-12-mobile' %}
          {% elseif column_left or column_right %}
          {% set class = 'column is-7-desktop is-12-tablet is-12-mobile' %}
          {% else %}
          {% set class = 'column is-6-desktop is-12-tablet is-12-mobile' %}
          {% endif %}
          <div id="product" class="product-info {{ class }}">
            <div id="product-main" itemprop="offers" itemscope itemtype="https://schema.org/Offer">
              <div class="is-flex is-justify-content-space-between">
                {% if price %}
                <div class="price is-relative is-size-2-desktop is-size-2-tablet is-size-3-mobile mb-5">
                  {% if not special %}
                  <span class="has-text-weight-bold actual-price" itemprop="price">{{ price }}{% if quantity_unit %}<small class="has-text-grey"> / {{ quantity_unit }}</small>{% endif %}</span>
                  {% else %}
                  <span class="has-text-weight-bold actual-price" itemprop="price">{{ special }}{% if quantity_unit %}<small class="has-text-grey"> / {{ quantity_unit }}</small>{% endif %}</span>
                  <span class="has-text-grey is-size-4 old-price">{{ price }}</span>
                  {% endif %}
                  {% if tax %}
                  <span class="has-text-grey is-size-7 price-tax">{{ text_tax }} {{ tax }}</span>
                  {% endif %}
                </div>
                {% endif %}
                {% if rating %}
                <span
                  class="tag is-medium is-light is-clickable" data-target="#product-reviews">
                  <span class="icon-text">
                    <span class="icon has-text-warning">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                        class="bi bi-star-fill" viewBox="0 0 16 16">
                        <path
                          d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z" />
                      </svg>
                    </span>
                    <span class="has-text-weight-bold">{{ rating }}</span>
                  </span>
                </span>
                {% endif %}
              </div>
              {% if price and discounts %}
              <div class="block mb-2 product-discounts is-clickable">
                <div class="dropdown is-hoverable">
                  <div class="dropdown-trigger">
                    <div class="title is-6">
                      <span class="has-text-link">{{ text_wholesale }}</span>
                    </div>
                  </div>
                  <div class="dropdown-menu" id="dropdown-menu4" role="menu">
                    <div class="dropdown-content">
                      {% for discount in discounts %}
                      <div class="dropdown-item is-size-6">
                        <span class="has-text-weight-bold">{{ discount.quantity }}</span>
                        <span class="">{{ text_discount }}</span>
                        <span class="has-text-weight-bold">{{ discount.price }}</span>
                      </div>
                      {% endfor %}
                    </div>
                  </div>
                </div>
              </div>
              {% endif %}
              <ul class="heading-list">
                {% if points %}
                <li class="is-flex is-justify-content-space-between is-align-items-center py-1">
                  <span class="pr-1">{{ text_points }}</span>
                  <span class="has-text-weight-bold pl-1">{{ points }}</span>
                </li>
                {% endif %}
                <li class="is-flex is-justify-content-space-between is-align-items-center py-1">
                  <span class="pr-1">{{ text_model }}</span>
                  <span class="has-text-weight-bold pl-1">{{ model }}</span>
                </li>
                <li class="is-flex is-justify-content-space-between is-align-items-center py-1">
                  <span class="pr-1">{{ text_stock }}</span>
                  <span
                    class="tag has-text-weight-bold {{ quantity > 0 ? 'is-success' : 'is-danger' }} is-light"
                    itemprop="availability">{{ stock }}</span>
                </li>
                {% if manufacturer %}
                <li class="is-flex is-justify-content-space-between is-align-items-center py-1">
                  <span class="pr-1">{{ text_manufacturer }}</span>
                  <a class="has-text-weight-bold pl-1" href="{{ manufacturers }}">{{ manufacturer }}</a>
                </li>
                {% endif %}
                {% if reward %}
                <li class="is-flex is-justify-content-space-between is-align-items-center py-1">
                  <span class="pr-1">{{ text_reward }}</span>
                  <span class="has-text-weight-bold pl-1">{{ reward }}</span>
                </li>
                {% endif %}
              </ul>
            </div>
            {% if options %}
            <div id="product-options" class="mt-5">
              <div class="title is-4">{{ text_option }}</div>
              {% for option in options %}
              {% if option.type == 'select' %}
              <div class="field{% if option.required %} required {% endif %}">
                <label class="label is-size-5" for="input-option{{ option.product_option_id }}">{{ option.name }}</label>
                <div class="control">
                  <div class="select">
                    <select name="option[{{ option.product_option_id }}]"
                      id="input-option{{ option.product_option_id }}">
                      <option value="">{{ text_select }}</option>
                      {% for option_value in option.product_option_value %}
                      <option value="{{ option_value.product_option_value_id }}" data-price="{{ option_value.price_numeric }}" data-prefix="{{ option_value.price_prefix }}" {{ option_value.is_default ? 'selected' : '' }}>{{ option_value.name }}
                        {% if show_options_price and option_value.price %}
                        ({{ option_value.price_prefix }}{{ option_value.price }})
                        {% endif %}
                      </option>
                      {% endfor %}
                    </select>
                  </div>
                </div>
              </div>
              {% endif %}
              {% if option.type == 'radio' %}
              <div class="field{% if option.required %} required {% endif %} mb-5">
                <label class="label is-size-5 mb-5">{{ option.name }}</label>
                {% if option.product_option_value | filter(v => v.product_link is defined and v.product_link != '') | length > 0 %}
                <div class="columns is-mobile is-multiline is-variable is-2" id="input-option{{ option.product_option_id }}">
                  {% for option_value in option.product_option_value %}
                  <div class="column is-3-desktop is-3-tablet is-4-mobile">
                    {% if option_value.product_link %}
                    <a href="{{ option_value.product_link }}" class="radio-ui is-relative is-flex is-align-items-center is-flex-direction-column p-2 has-text-centered">
                      <input type="radio" name="option[{{ option.product_option_id }}]" data-price="{{ option_value.price_numeric }}" data-prefix="{{ option_value.price_prefix }}" {{ option_value.is_default ? 'checked' : '' }} value="{{ option_value.product_option_value_id }}" />
                      {% if option_value.image %}
                      <img class="mb-2" src="{{ option_value.image }}" alt="{{ option_value.name }} {% if option_value.price %} {{ option_value.price_prefix }} {{ option_value.price }} {% endif %}" />
                      {% endif %}
                      <span class="is-size-7">{{ option_value.name }}</span>
                    </a>
                    {% else %}
                    <label class="radio-ui is-relative is-flex is-align-items-center is-flex-direction-column p-2 has-text-centered">
                      <input type="radio" name="option[{{ option.product_option_id }}]" data-price="{{ option_value.price_numeric }}" data-prefix="{{ option_value.price_prefix }}" {{ option_value.is_default ? 'checked' : '' }} value="{{ option_value.product_option_value_id }}" />
                      {% if option_value.image %}
                      <img class="mb-2" src="{{ option_value.image }}" alt="{{ option_value.name }} {% if option_value.price %} {{ option_value.price_prefix }} {{ option_value.price }} {% endif %}" />
                      {% endif %}
                      <span class="is-size-7">{{ option_value.name }}</span>
                    </label>
                    {% endif %}                    
                  </div>
                  {% endfor %}
                </div>
                {% else %}
                <div class="columns is-mobile is-multiline is-variable is-2" id="input-option{{ option.product_option_id }}">
                  {% for option_value in option.product_option_value %}
                  <div class="column is-3-desktop is-3-tablet is-6-mobile">
                    <label class="radio-ui is-relative is-flex is-align-items-center is-flex-direction-column p-2 has-text-centered">
                      <input type="radio" name="option[{{ option.product_option_id }}]" data-price="{{ option_value.price_numeric }}" data-prefix="{{ option_value.price_prefix }}" {{ option_value.is_default ? 'checked' : '' }} value="{{ option_value.product_option_value_id }}" />
                      {% if option_value.image %}
                      <img src="{{ option_value.image }}" alt="{{ option_value.name }} {% if option_value.price %} {{ option_value.price_prefix }} {{ option_value.price }} {% endif %}" />
                      {% endif %}
                      {{ option_value.name }}
                      {% if show_options_price and option_value.price %}
                      <span class="tag is-light">{{ option_value.price_prefix }}{{ option_value.price }}</span>
                      {% endif %}
                    </label>                  
                  </div>
                  {% endfor %}
                </div>
                {% endif %}                
              </div>
              {% endif %}
              {% if option.type == 'checkbox' %}
              <div class="field{% if option.required %} required {% endif %}">
                <label class="label is-size-5">{{ option.name }}</label>
                <div class="control" id="input-option{{ option.product_option_id }}">
                  {% for option_value in option.product_option_value %}
                  <div>
                    <label class="checkbox">
                      <input type="checkbox" name="option[{{ option.product_option_id }}][]" data-price="{{ option_value.price_numeric }}" data-prefix="{{ option_value.price_prefix }}" {{ option_value.is_default ? 'checked' : '' }}
                        value="{{ option_value.product_option_value_id }}" />
                      {% if option_value.image %} <img src="{{ option_value.image }}"
                        alt="{{ option_value.name }} {% if option_value.price %} {{ option_value.price_prefix }} {{ option_value.price }} {% endif %}"
                        class="img-thumbnail" /> {% endif %}
                      {{ option_value.name }}
                      {% if show_options_price and option_value.price %}
                      <span class="tag is-light">{{ option_value.price_prefix }}{{ option_value.price }}</span>
                      {% endif %}
                    </label>
                  </div>
                  {% endfor %}
                </div>
              </div>
              {% endif %}
              {% if option.type == 'text' %}
              <div class="field{% if option.required %} required {% endif %}">
                <label class="label is-size-5" for="input-option{{ option.product_option_id }}">{{ option.name }}</label>
                <input type="text" name="option[{{ option.product_option_id }}]" value="{{ option.value }}"
                  placeholder="{{ option.name }}" id="input-option{{ option.product_option_id }}" class="input" />
              </div>
              {% endif %}
              {% if option.type == 'textarea' %}
              <div class="field{% if option.required %} required {% endif %}">
                <label class="label is-size-5" for="input-option{{ option.product_option_id }}">{{ option.name }}</label>
                <textarea name="option[{{ option.product_option_id }}]" rows="5" placeholder="{{ option.name }}"
                  id="input-option{{ option.product_option_id }}" class="textarea">{{ option.value }}</textarea>
              </div>
              {% endif %}
              {% if option.type == 'file' %}
              <div class="field{% if option.required %} required {% endif %}">
                <label class="label is-size-5">{{ option.name }}</label>
                <button type="button" id="button-upload{{ option.product_option_id }}"
                  class="button is-primary is-light">{{ button_upload }}</button>
                <input type="hidden" name="option[{{ option.product_option_id }}]" value=""
                  id="input-option{{ option.product_option_id }}" />
              </div>
              {% endif %}
              {% if option.type == 'date' %}
              <div class="field{% if option.required %} required {% endif %}">
                <label class="label is-size-5" for="input-option{{ option.product_option_id }}">{{ option.name }}</label>
                <div class="control">
                  <input type="date" name="option[{{ option.product_option_id }}]" value="{{ option.value }}"
                    id="input-option{{ option.product_option_id }}" class="input" />
                </div>
              </div>
              {% endif %}
              {% if option.type == 'datetime' %}
              <div class="field{% if option.required %} required {% endif %}">
                <label class="label is-size-5" for="input-option{{ option.product_option_id }}">{{ option.name }}</label>
                <div class="control">
                  <input type="datetime-local" name="option[{{ option.product_option_id }}]" value="{{ option.value }}"
                    id="input-option{{ option.product_option_id }}" class="input" />
                </div>
              </div>
              {% endif %}
              {% if option.type == 'time' %}
              <div class="field{% if option.required %} required {% endif %}">
                <label class="label is-size-5" for="input-option{{ option.product_option_id }}">{{ option.name }}</label>
                <div class="control">
                  <input type="time" name="option[{{ option.product_option_id }}]" value="{{ option.value }}"
                    id="input-option{{ option.product_option_id }}" class="input" />
                </div>
              </div>
              {% endif %}
              {% endfor %}
            </div>
            {% endif %}
            {% if recurrings %}
            <hr>
            <div class="field required product-recurring">
              <label class="label is-size-5">{{ text_payment_recurring }}</label>
              <div class="control">
                <div class="select is-fullwidth">
                  <select name="recurring_id">
                    <option value="">{{ text_select }}</option>
                    {% for recurring in recurrings %}
                    <option value="{{ recurring.recurring_id }}">{{ recurring.name }}</option>
                    {% endfor %}
                  </select>
                </div>
              </div>
              <div class="help is-info" id="recurring-description"></div>
            </div>
            <hr>
            {% endif %}
            <div id="product-actions" class="mt-5 is-flex is-align-items-center is-justify-content-space-between">
              <div class="field has-addons mb-0 quantity-counter">
                <p class="control">
                  <a class="button minus">
                    <span class="icon">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                        viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M2 8a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11A.5.5 0 0 1 2 8Z" />
                      </svg>
                    </span>
                  </a>
                </p>
                <p class="control">
                  <input type="text" style="max-width: 60px" name="quantity"
                    class="input has-text-centered input-quantity" value="{{ minimum }}" maxlength="5" />
                </p>
                <p class="control">
                  <a class="button plus">
                    <span class="icon">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                        viewBox="0 0 16 16">
                        <path fill-rule="evenodd"
                          d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2Z" />
                      </svg>
                    </span>
                  </a>
                </p>
                <p class="control">
                  <button id="button-cart" class="button is-primary" name="button">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="-0.5 -0.5 16 16" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" height="24" width="24">
                      <path d="M6.5625 6.25h2.5m-1.25 -1.25v2.5m2.5 5.625a0.9375 0.9375 0 1 0 0 -1.875 0.9375 0.9375 0 0 0 0 1.875m-5 0a0.9375 0.9375 0 1 0 0 -1.875 0.9375 0.9375 0 0 0 0 1.875M2.31875 3.375h9.508750000000001c0.86125 0 1.4831250000000002 0.79375 1.2468750000000002 1.5925l-1.03375 3.5C11.881250000000001 9.004999999999999 11.3725 9.375 10.79375 9.375H5.07c-0.579375 0 -1.08875 -0.370625 -1.2475 -0.9075zm0 0L1.875 1.875" stroke-width="1"></path>
                    </svg>
                  </button>
                </p>
              </div>
              <input type="hidden" name="product_id" value="{{ product_id }}" />
              <div class="buttons is-right">
                <button type="button" class="add-to-wishlist button is-primary is-light" title="{{ button_wishlist }}"
                  data-product_id="{{ product_id }}">
                  <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="-0.5 -0.5 16 16" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" height="24" width="24">
                      <path d="M4.84375 2.1875C3.2043749999999998 2.1875 1.875 3.5999999999999996 1.875 5.341875 1.875 8.828125 7.5 12.8125 7.5 12.8125s5.625 -3.984375 5.625 -7.470625C13.125 3.1837500000000003 11.795625000000001 2.1875 10.15625 2.1875c-1.1625 0 -2.16875 0.71 -2.65625 1.74375 -0.48750000000000004 -1.03375 -1.4937500000000001 -1.74375 -2.65625 -1.74375" stroke-width="1"></path>
                    </svg>
                  </span>
                </button>
                <button type="button" class="add-to-compare button is-primary is-light" title="{{ button_compare }}"
                  data-product_id="{{ product_id }}">
                  <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="-0.5 -0.5 16 16" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" height="24" width="24">
                      <path d="M9.375 5.893125V3.125a1.25 1.25 0 0 0 -1.25 -1.25h-1.25a1.25 1.25 0 0 0 -1.25 1.25v5.17875m3.75 -2.410625V13.125m0 -7.231875h2.5a1.25 1.25 0 0 1 1.25 1.25V11.875a1.25 1.25 0 0 1 -1.25 1.25h-2.5m0 0H5.625m0 0v-4.82125M5.625 13.125H3.125a1.25 1.25 0 0 1 -1.25 -1.25v-2.32125a1.25 1.25 0 0 1 1.25 -1.25h2.5" stroke-width="1"></path>
                    </svg>
                  </span>
                </button>
              </div>
            </div>
            {% if minimum > 1 %}
            <p class="help is-danger">{{ text_minimum }}</p>
            {% endif %}
            <hr class="mb-0">
            {% if attribute_groups %}
            <div id="product-attributes" class="my-5">
              <div class="title is-4">
                {{ tab_attribute }}
              </div>
              <div class="attribute-group">
                {% for attribute_group in attribute_groups %}
                <div class="title is-5 my-3">
                  {{ attribute_group.name }}
                </div>
                <ul class="heading-list">
                  {% for attribute in attribute_group.attribute %}
                  <li class="is-flex is-justify-content-space-between is-align-items-center py-1">
                    <span class="pr-1 is-flex is-align-items-center">
                    {% if attribute.icon %}
                    {{ attribute.icon|html_entity_decode }}
                    {% endif %}
                    {{ attribute.name }}
                    {% if attribute.hint %}
                      <span class="attribute-hint-trigger icon has-text-info is-clickable ml-1" data-hint="{{ attribute.hint|html_entity_decode }}">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="-0.5 -0.5 16 16" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" height="20" width="20">
                          <path d="M7.5 8.435c0 -1.251875 1.25 -0.939375 1.25 -2.1912499999999997 0 -1.6618749999999998 -2.5 -1.6618749999999998 -2.5 0m1.25 3.7543749999999996v-0.3125" stroke-width="1"></path>
                          <path d="M1.875 7.5a5.625 5.625 0 1 0 11.25 0 5.625 5.625 0 1 0 -11.25 0" stroke-width="1"></path>
                        </svg>
                      </span>                    
                    {% endif %}
                    </span>
                    <span class="has-text-weight-bold pl-1">{{ attribute.text }}</span>
                  </li>
                  {% endfor %}
                </ul>
                {% endfor %}
              </div>
              <hr>
            </div>
            {% endif %}
            <div id="product-description" itemprop="description" >
              {{ description }}
            </div>
            {% if tags %}
            <div id="product-tags" class="mt-5">
              <div class="title is-5 mb-2">
                {{ text_tags }}
              </div>
              {% for i in 0..tags|length - 1 %}
              {% if i < (tags|length - 1) %} 
              <a class="tag is-medium is-link is-light" href="{{ tags[i].href }}">#{{ tags[i].tag }}</a>
              {% else %}
              <a class="tag is-medium is-link is-light" href="{{ tags[i].href }}">#{{ tags[i].tag }}</a>
              {% endif %}
              {% endfor %}
            </div>
            {% endif %}
            {% if review_status %}
            <hr>
            <div id="product-reviews" class="mb-5">
              <div class="title is-4">
                {{ tab_review }}
              </div>
              <div id="reviews"></div>
              <hr>
              <form id="form-review">                                
                <div class="title is-4">{{ text_write }}</div>
                {% if review_guest %}
                <div class="field">
                  <label class="label">{{ entry_rating }}</label>
                  <div class="control is-flex is-align-items-center score">
                    <span class="tag is-light is-clickable mr-1" data-score="1">
                      <span class="icon-text">
                        <span class="icon">
                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                            class="bi bi-star" viewBox="0 0 16 16">
                            <path
                              d="M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.565.565 0 0 0-.163-.505L1.71 6.745l4.052-.576a.525.525 0 0 0 .393-.288L8 2.223l1.847 3.658a.525.525 0 0 0 .393.288l4.052.575-2.906 2.77a.565.565 0 0 0-.163.506l.694 3.957-3.686-1.894a.503.503 0 0 0-.461 0z" />
                          </svg>
                        </span>
                        <span>1</span>
                      </span>
                    </span>
                    <span class="tag is-light is-clickable mr-1" data-score="2">
                      <span class="icon-text">
                        <span class="icon">
                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                            class="bi bi-star" viewBox="0 0 16 16">
                            <path
                              d="M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.565.565 0 0 0-.163-.505L1.71 6.745l4.052-.576a.525.525 0 0 0 .393-.288L8 2.223l1.847 3.658a.525.525 0 0 0 .393.288l4.052.575-2.906 2.77a.565.565 0 0 0-.163.506l.694 3.957-3.686-1.894a.503.503 0 0 0-.461 0z" />
                          </svg>
                        </span>
                        <span>2</span>
                      </span>
                    </span>
                    <span class="tag is-light is-clickable mr-1" data-score="3">
                      <span class="icon-text">
                        <span class="icon">
                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                            class="bi bi-star" viewBox="0 0 16 16">
                            <path
                              d="M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.565.565 0 0 0-.163-.505L1.71 6.745l4.052-.576a.525.525 0 0 0 .393-.288L8 2.223l1.847 3.658a.525.525 0 0 0 .393.288l4.052.575-2.906 2.77a.565.565 0 0 0-.163.506l.694 3.957-3.686-1.894a.503.503 0 0 0-.461 0z" />
                          </svg>
                        </span>
                        <span>3</span>
                      </span>
                    </span>
                    <span class="tag is-light is-clickable mr-1" data-score="4">
                      <span class="icon-text">
                        <span class="icon">
                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                            class="bi bi-star" viewBox="0 0 16 16">
                            <path
                              d="M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.565.565 0 0 0-.163-.505L1.71 6.745l4.052-.576a.525.525 0 0 0 .393-.288L8 2.223l1.847 3.658a.525.525 0 0 0 .393.288l4.052.575-2.906 2.77a.565.565 0 0 0-.163.506l.694 3.957-3.686-1.894a.503.503 0 0 0-.461 0z" />
                          </svg>
                        </span>
                        <span>4</span>
                      </span>
                    </span>
                    <span class="tag is-light is-clickable" data-score="5">
                      <span class="icon-text">
                        <span class="icon">
                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                            class="bi bi-star" viewBox="0 0 16 16">
                            <path
                              d="M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.565.565 0 0 0-.163-.505L1.71 6.745l4.052-.576a.525.525 0 0 0 .393-.288L8 2.223l1.847 3.658a.525.525 0 0 0 .393.288l4.052.575-2.906 2.77a.565.565 0 0 0-.163.506l.694 3.957-3.686-1.894a.503.503 0 0 0-.461 0z" />
                          </svg>
                        </span>
                        <span>5</span>
                      </span>
                    </span>
                    <input type="hidden" name="rating" value="">
                  </div>
                </div>
                <div class="field" style="max-width: 400px">
                  <label class="label" for="input-name">{{ entry_name }}</label>
                  <input type="text" name="name" value="{{ customer_name }}" placeholder="{{ entry_name }}"
                    id="input-name" class="input" />
                </div>
                <div class="field">
                  <label class="label" for="input-review">{{ entry_review }}</label>
                  <textarea name="text" rows="5" id="input-review" placeholder="{{ entry_review }}"
                    class="textarea"></textarea>
                </div>                
                {% if review_images %}
                <div class="field files-input">
                  <div class="file">
                    <label class="file-label">
                      <input class="file-input" type="file" id="form-review-add-images" multiple accept="{{ accept_types }}">
                      <span class="file-cta">
                        <span class="icon file-icon">
                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M4.502 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3"/>
                            <path d="M14.002 13a2 2 0 0 1-2 2h-10a2 2 0 0 1-2-2V5A2 2 0 0 1 2 3a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v8a2 2 0 0 1-1.998 2M14 2H4a1 1 0 0 0-1 1h9.002a2 2 0 0 1 2 2v7A1 1 0 0 0 15 11V3a1 1 0 0 0-1-1M2.002 4a1 1 0 0 0-1 1v8l2.646-2.354a.5.5 0 0 1 .63-.062l2.66 1.773 3.71-3.71a.5.5 0 0 1 .577-.094l1.777 1.947V5a1 1 0 0 0-1-1z"/>
                          </svg>
                        </span>
                        <span class="file-label">
                          {{ entry_images }}
                        </span>
                      </span>
                    </label>
                  </div>
                  <div class="preview-container"></div>
                </div>                  
                {% endif %}
                {{ captcha }}
                <div class="buttons">
                  <button type="button" id="button-review" class="button is-primary">
                    <span class="icon">
                      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="-0.5 -0.5 16 16" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" height="24" width="24">
                        <path d="M7.5 13.125a5.625 5.625 0 1 0 -5.625 -5.625c0 0.8999999999999999 0.21125000000000002 1.75 0.5874999999999999 2.5043749999999996 0.283125 0.569375 -0.110625 1.3375000000000001 -0.260625 1.8981249999999998a0.73125 0.73125 0 0 0 0.895625 0.895625c0.560625 -0.15 1.3287499999999999 -0.54375 1.8981249999999998 -0.26A5.6025 5.6025 0 0 0 7.5 13.125" stroke-width="1"></path>
                      </svg>
                    </span>
                    <span>
                      {{ button_send }}
                    </span>                    
                  </button>
                </div>
                {% else %}
                {{ text_login }}
                {% endif %}
              </form>
            </div>
            {% endif %}
          </div>
          {% if products %}
          <div class="column is-12 my-5 product-related">
            <hr>
            <h3 class="title is-3">{{ text_related }}</h3>
            <div class="columns is-mobile is-multiline mt-5">
              {% if column_left and column_right %}
              {% set class = 'column is-4-fullhd is-4-widescreen is-4-desktop is-4-tablet is-6-mobile' %}
              {% elseif column_left or column_right %}
              {% set class = 'column is-3-fullhd is-3-widescreen is-4-desktop is-4-tablet is-6-mobile' %}
              {% else %}
              {% set class = 'column is-3-fullhd is-3-widescreen is-3-desktop is-4-tablet is-6-mobile' %}
              {% endif %}
              {% for product in products %}
              <div class="{{ class }}">
                <div class="product-card card is-clipped">
                  <div class="card-image">
                    <figure class="image">
                      <a href="{{ product.href }}" class="is-flex is-justify-content-center" aria-label="{{ product.name }}">
                        <img src="{{ product.thumb }}" loading="lazy" alt="{{ product.name }}" title="{{ product.name }}" />
                      </a>
                      <span class="stock tag {{ product.quantity ? 'is-success' : 'is-danger' }} is-light">{{ product.stock }}</span>
                      {% if product.stickers %}
                      <span class="stickers is-block mb-0">
                      {% for sticker in product.stickers %}
                      <span class="is-block">
                        <span class="{{ sticker.class }}">{{ sticker.content|html_entity_decode }}</span>
                      </span>                    
                      {% endfor %}
                      </span>
                      {% endif %}
                      {% if product.discount %}
                      <span class="discount tag is-danger">-{{ product.discount }}%</span>
                      {% endif %}
                    </figure>
                  </div>
                  <div class="card-content">
                    <div class="mb-3">
                      <a class="product-name is-size-6" href="{{ product.href }}">{{ product.name }}</a>
                    </div>                  
                    <div class="is-flex is-justify-content-space-between is-align-items-center">
                      {% if product.price %}
                      <div class="price">
                        {% if not product.special %}
                        <span class="actual-price">{{ product.price }}{% if product.quantity_unit %}<small class="has-text-grey"> / {{ product.quantity_unit }}</small>{% endif %}</span>
                        {% else %}
                        <span class="actual-price">{{ product.special }}{% if product.quantity_unit %}<small class="has-text-grey"> / {{ product.quantity_unit }}</small>{% endif %}</span>
                        <span class="old-price has-text-grey">{{ product.price }}</span>
                        {% endif %}
                        {% if product.tax %}
                        <span class="price-tax has-text-grey is-size-7">{{ text_tax }} {{ product.tax }}</span>
                        {% endif %}
                      </div>
                      {% endif %}
                      {% if product.rating %}
                      <span class="tag is-light">
                        <span class="icon-text">
                          <span class="icon has-text-warning">
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-star-fill" viewBox="0 0 16 16">
                              <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
                            </svg>
                          </span>
                          <span class="has-text-weight-bold">{{ product.rating }}</span>
                        </span>
                      </span>
                      {% endif %}
                    </div>
                  </div>
                  <div class="actions columns is-mobile is-variable is-1 p-2 m-0">
                    <div class="column is-4">
                      <button type="button" class="add-to-cart button is-primary is-light is-fullwidth" title="{{ button_cart }}" data-product_id="{{ product.product_id }}" data-minimum="{{ product.minimum }}">                   
                        <span class="icon">
                          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="-0.5 -0.5 16 16" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" height="24" width="24">
                            <path d="M6.5625 6.25h2.5m-1.25 -1.25v2.5m2.5 5.625a0.9375 0.9375 0 1 0 0 -1.875 0.9375 0.9375 0 0 0 0 1.875m-5 0a0.9375 0.9375 0 1 0 0 -1.875 0.9375 0.9375 0 0 0 0 1.875M2.31875 3.375h9.508750000000001c0.86125 0 1.4831250000000002 0.79375 1.2468750000000002 1.5925l-1.03375 3.5C11.881250000000001 9.004999999999999 11.3725 9.375 10.79375 9.375H5.07c-0.579375 0 -1.08875 -0.370625 -1.2475 -0.9075zm0 0L1.875 1.875" stroke-width="1"></path>
                          </svg>  
                        </span>                         
                      </button>
                    </div>
                    <div class="column is-4">
                      <button type="button" class="add-to-wishlist button is-primary is-light is-fullwidth" title="{{ button_wishlist }}" data-product_id="{{ product.product_id }}">
                        <span class="icon">
                          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="-0.5 -0.5 16 16" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" height="24" width="24">
                            <path d="M4.84375 2.1875C3.2043749999999998 2.1875 1.875 3.5999999999999996 1.875 5.341875 1.875 8.828125 7.5 12.8125 7.5 12.8125s5.625 -3.984375 5.625 -7.470625C13.125 3.1837500000000003 11.795625000000001 2.1875 10.15625 2.1875c-1.1625 0 -2.16875 0.71 -2.65625 1.74375 -0.48750000000000004 -1.03375 -1.4937500000000001 -1.74375 -2.65625 -1.74375" stroke-width="1"></path>
                          </svg>
                        </span>
                      </button>
                    </div>
                    <div class="column is-4">
                      <button type="button" class="add-to-compare button is-primary is-light is-fullwidth" title="{{ button_compare }}" data-product_id="{{ product.product_id }}">
                        <span class="icon">
                          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="-0.5 -0.5 16 16" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" height="24" width="24">
                            <path d="M9.375 5.893125V3.125a1.25 1.25 0 0 0 -1.25 -1.25h-1.25a1.25 1.25 0 0 0 -1.25 1.25v5.17875m3.75 -2.410625V13.125m0 -7.231875h2.5a1.25 1.25 0 0 1 1.25 1.25V11.875a1.25 1.25 0 0 1 -1.25 1.25h-2.5m0 0H5.625m0 0v-4.82125M5.625 13.125H3.125a1.25 1.25 0 0 1 -1.25 -1.25v-2.32125a1.25 1.25 0 0 1 1.25 -1.25h2.5" stroke-width="1"></path>
                          </svg>
                        </span>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              {% endfor %}
            </div>
          </div>
          {% endif %}
        </div>
      </div>
      {{ column_right }}
    </div>
  </div>
  {{ content_bottom }}
</main>

<script>
  $('select[name="recurring_id"], input[name="quantity"]').change(function () {
    $.ajax({
      url: 'index.php?route=product/product/getRecurringDescription',
      type: 'post',
      data: $('input[name="product_id"], input[name="quantity"], select[name="recurring_id"]'),
      dataType: 'json',
      beforeSend: function () {
        $('#recurring-description').html('');
      },
      success: function (json) {
        $('.product-recurring .help.is-danger').remove();

        if (json['success']) {
          $('#recurring-description').html(json['success']);
        }
      }
    });
  });

  $('body').on('click', '#product-page [data-target]', function () {
    if ($(this).data('target')) {
      $(this).siblings().removeClass('is-active');
      $(this).addClass('is-active');

      let section = $($(this).data('target'))[0];
    
      if (section) {
        window.scrollTo({
          top: section.offsetTop,
          behavior: 'smooth'
        });
      }
    }
  });
  
  {% if price %}
  
  $('#product-options input[type="radio"], #product-options input[type="checkbox"], #product-options select').on('change', function () {
    let basePrice = {{ price_numeric }};
    let currentPrice = basePrice;

    $('#product-options input[type="radio"]:checked, #product-options input[type="checkbox"]:checked, #product-options select').each(function () {
      let price = parseFloat($(this).find('option:selected').data('price') || $(this).data('price') || 0);
      let prefix = $(this).find('option:selected').data('prefix') || $(this).data('prefix') || '+';  // По умолчанию +

      switch (prefix) {
        case '+':
          currentPrice += price;
          break;
        case '-':
          currentPrice -= price;
          break;
        case '*':
          currentPrice *= price;
          break;
        case '/':
          currentPrice = price !== 0 ? currentPrice / price : currentPrice;
          break;
        case '=':
          currentPrice = price;
          break;
        default:
          currentPrice += price;
      }
    });

    let formatter = new Intl.NumberFormat('{{ language_code }}',
      { style: 'currency', 
        currency: '{{ currency_code }}',
        currencyDisplay: 'narrowSymbol',
        maximumFractionDigits: (basePrice.toString().split('.')[1] || '').length
      });
    
    let formattedPrice = formatter.format(currentPrice);
    let unit = '{{ quantity_unit }}' ? '<small class="has-text-grey"> / {{quantity_unit}}</small>' : '';
    $('#product-main .actual-price').html(formattedPrice + unit);
  });
  // trigger change to set initial price by default options
  $('#product-options input[type="radio"], #product-options input[type="checkbox"], #product-options select').trigger('change');
  
  {% endif %}

  {% if attribute_groups %}
  if ($('.attribute-hint-trigger').length) {
    $('.attribute-hint-trigger').on('click', function () {
      let content = $(this).data('hint');

      notification({
        type: 'info',
        text: content,
        duration: 10000
      });
    });
  }  
  {% endif %}

  $('#button-cart').on('click', function () {
    $.ajax({
      url: 'index.php?route=checkout/cart/add',
      type: 'post',
      data: $('#product input[type="text"], #product input[type="hidden"], #product input[type="date"], #product input[type="time"], #product input[type="datetime-local"], #product input[type="radio"]:checked, #product input[type="checkbox"]:checked, #product select, #product textarea'),
      dataType: 'json',
      beforeSend: function () {
        $('#button-cart').addClass('is-loading');
      },
      complete: function () {
        $('#button-cart').removeClass('is-loading');
      },
      success: function (json) {
        $('.field .help.is-danger').remove();
        $('.field .input, .field .select, .field .textarea').removeClass('is-danger');

        if (json['error']) {
          if (json['error']['option']) {
            for (i in json['error']['option']) {
              let el = $('#input-option' + i.replace('_', '-')).parents('.field');
              el.find('.input, .select, .textarea').addClass('is-danger');
              el.append('<div class="help is-danger">' + json['error']['option'][i] + '</div>');
            }
          }

          if (json['error']['recurring']) {
            $('select[name="recurring_id"]').after('<div class="help is-danger">' + json['error']['recurring'] + '</div>');
          }

          $('html, body').stop().animate({ scrollTop: $('#product .help.is-danger').first().offset().top - 240 }, 300);

        }

        if (json['success']) {

          updateCartBadge(json['total']);

          notification({
            type: 'success',
            text: json['success'],
          });

          $('#cart-modal .modal-card-body').load('index.php?route=common/cart/info .modal-cart-products');

        }
      },
      error: function (xhr, ajaxOptions, thrownError) {
        alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
      }
    });
  });

  $('button[id^="button-upload"]').on('click', function () {
    let node = this;

    $('#form-upload').remove();

    $('body').prepend('<form enctype="multipart/form-data" id="form-upload" style="display: none;"><input type="file" name="file" /></form>');

    $('#form-upload input[name="file"]').trigger('click');

    if (typeof timer != 'undefined') {
      clearInterval(timer);
    }

    timer = setInterval(function () {
      if ($('#form-upload input[name="file"]').val() != '') {
        clearInterval(timer);

        $.ajax({
          url: 'index.php?route=tool/upload',
          type: 'post',
          dataType: 'json',
          data: new FormData($('#form-upload')[0]),
          cache: false,
          contentType: false,
          processData: false,
          beforeSend: function () {
            $(node).addClass('is-loading');
          },
          complete: function () {
            $(node).removeClass('is-loading');
          },
          success: function (json) {
            $(node).find('.is-danger, .is-success').remove();

            if (json['error']) {
              $(node).parent().append('<p class="help is-danger">' + json['error'] + '</p>');
            }

            if (json['success']) {
              $(node).parent().find('.is-danger').remove();
              $(node).parent().append('<p class="help is-success">' + json['success'] + '</p>');
              $(node).parent().find('input').val(json['code']);
            }
          },
          error: function (xhr, ajaxOptions, thrownError) {
            alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
          }
        });
      }
    }, 500);
  });

  $('body').on('click', '.score .tag', function () {
    $(this).siblings().removeClass('is-active');
    $(this).addClass('is-active');

    $(this).parent().find('input[name="rating"]').val($(this).data('score'));
  });

  $('#reviews').delegate('.pagination a', 'click', function (e) {
    e.preventDefault();

    $('#reviews').fadeOut(100);

    $('#reviews').load(this.href);

    $('#reviews').fadeIn(100, function () {
      let top = $('#reviews').offset().top;
      let offset = $(window).width() > 768 ? 120 : 60;

      $('html, body').stop().animate({ scrollTop: top - offset }, 300);
    });
  });

  $('#reviews').load('index.php?route=product/product/review&product_id={{ product_id }}');

  {% if review_images %}

  const reviewImagesManager = previewManager({
    container: '#form-review .preview-container',
    maxSize: {{ file_max_size }},
    allowedMimes: {{ allowed_image_mimes }},
    maxFiles: {{ review_images_limit|default(5) }}
  });

  $('#form-review-add-images').on('change', function () {

    for (let file of this.files) {
      reviewImagesManager.addFile(file);
    }

    this.value = '';
  });

  {% endif %}

  $('#button-review').on('click', function () {
    let $button = $(this);
    let $form = $('#form-review');

    const formData = new FormData($form[0]);
    
    {% if review_images %}

    const images = reviewImagesManager.getQueue();

    for (let id in images) {
      formData.append('images[]', images[id]);
    }

    {% endif %}

    $.ajax({
      url: 'index.php?route=product/product/write&product_id={{ product_id }}',
      data: formData,
      dataType: 'json',
      cache: false,
      contentType: false,
      processData: false,
      type: 'post',
      beforeSend: function () {
        $button.addClass('is-loading');
      },
      complete: function () {
        $button.removeClass('is-loading');
      },
      success: function (json) {

        $button.removeClass('is-loading');

        $form.find('.help.is-danger').remove();
        $form.find('.input.is-danger, .textarea.is-danger').removeClass('is-danger');

        if (json['error']) {
          for (let key in json['error']) {
            if (json['error'][key]) {
              $form.find('input[name="' + key + '"], textarea[name="' + key + '"]').parents('.field').append('<p class="help is-danger">' + json['error'][key] + '</p>');
              $form.find('input[name="' + key + '"], textarea[name="' + key + '"]').addClass('is-danger');
            }

            if ($('.google-captcha').length && key == 'captcha') {
              $form.find('.google-captcha').append('<p class="help is-danger">' + json['error'][key] + '</p>');
            }
          }

          if ($form.find('.help.is-danger').length) {
            console.log('scroll');
            
            let offset = $(window).width() > 768 ? 180 : 90;
            $('html, body').stop().animate({ scrollTop: $form.find('.help.is-danger').first().offset().top - offset });
          }

          {% if review_images %}

          if (json['error']['type']) {
            $form.find('.file').after('<p class="help is-danger">' + json['error']['type'] + '</p>');
          }

          if (json['error']['size']) {
            $form.find('.file').after('<p class="help is-danger">' + json['error']['size'] + '</p>');
          }
          
          if (json['error']['limit']) {
            $form.find('.file').after('<p class="help is-danger">' + json['error']['limit'] + '</p>');
          }

          {% endif %}
        }

        if (json['success']) {
          
          notification({
            type: 'success',
            text: json['success']
          });

          $form.trigger('reset');
          $form.find('.score .tag.is-active').removeClass('is-active');

          $form.trigger('reset');

          {% if review_images %}
          reviewImagesManager.reset();
          {% endif %}
        }
      }
    });
  });

  $(document).ready(function () {
    const swiper = new Swiper('#product-images', {
      slidesPerView: 1,
      loop: true,
      pagination: {
        el: '#product-images .swiper-pagination',
        clickable: true,
      },
      autoplay: {
        delay: 5000,
      },
      speed: 750
    });

    Fancybox.bind("#product-images [data-fancybox]", {
      Thumbs : {
        type: "classic"
      },
      Toolbar: {
        display: {
          left: ["infobar"],
          middle: [],
          right: ["close"],
        },
      },
    });
  });

</script>
{{ footer }}